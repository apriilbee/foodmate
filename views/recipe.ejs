<!DOCTYPE html>
<html lang="en">
    <%- include('partials/head') %>
    <link rel="stylesheet" href="/css/recipe.css">
    <body>
        <%- include('partials/navbar') %>
        <div class="container recipe-container">   
            <div class="col s12 m7 left-content">
              <h4><%= recipe.title %></h4>
              <div>
                <% recipe.tags.forEach(tag => { %>
                  <div class="chip tag-chip"><%= tag %></div>
                <% }); %>
              </div>
              <div class="info-icons">
                <p><i class="material-icons">schedule</i> <%= recipe.readyInMinutes %> minutes</p>
                <p><i class="material-icons">restaurant</i> Serves <%= recipe.servings %></p>
                <% if (recipe.nutrition?.nutrients) { 
                  const calories = recipe.nutrition.nutrients.find(n => n.name === 'Calories');
                  const protein = recipe.nutrition.nutrients.find(n => n.name === 'Protein');
                  const sugar = recipe.nutrition.nutrients.find(n => n.name === 'Sugar');
                  const carbs = recipe.nutrition.nutrients.find(n => n.name === 'Carbohydrates');
                  if (calories) { %>
                      <p><i class="material-icons">local_fire_department</i> <%= calories.amount %> kcal</p>
                  <% } 
                  if (protein) { %>
                      <p><i class="material-icons">fitness_center</i> <%= protein.amount %> g Protein</p>
                  <% }
                  if (sugar) { %>
                      <p><i class="material-icons">icecream</i> <%= sugar.amount %> g Sugar</p>
                  <% } 
                  if (carbs) { %>
                    <p><i class="material-icons">bakery_dining</i> <%= carbs.amount %> g Carbs</p>
                <% }
              } %>
              </div>
              <button style="background-color: orange; color: white; padding: 10px 16px; border: none; border-radius: 8px;">
                Add to Meal Plan
              </button>
              <a href="/home" style="background-color: orange; color: white; padding: 8.5px 16px; border: none; border-radius: 8px; text-decoration: none; display: inline-block;">
                Back to Recipes
              </a>
              <h5>
                Ingredients</h5>
              <ul class="collection">
                <% recipe.formattedIngredients.forEach(ingredient => { %>
                  <li class="collection-item"><%= ingredient %></li>
                <% }) %>
              </ul>
              <% if (recipe.instructionDetails && recipe.instructionDetails.length > 0) { %>
                <h5>Instructions</h5>
                <div>
                  <% recipe.instructionDetails.forEach((step, index) => { %>
                    <div class="step">
                      <strong>Step <%= index + 1 %>:</strong> <%= step %>
                    </div>
                  <% }) %>
                </div>
              <% } %>              
            </div>
            <div class="col s12 m5 right-image">
              <div class="row">
                <img src="<%= recipe.image %>" alt="Recipe Image" class="recipe-image">
              </div> 
            </div>
        </div> 
        <%- include('partials/scripts') %>
    </body>        
</html>